<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PauseSleep by Dr Premila Hewage - Modern Medical Balwyn</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: #1a202c;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px 10px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: #ffffff;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            margin-bottom: 40px;
        }

        .header {
            background: #E8F4F5;
            color: #2d3748;
            padding: 40px 30px 30px 30px;
            text-align: center;
            border-bottom: 4px solid #319795;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            gap: 20px;
        }

        .logo-image {
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 50%;
        }

        .brand-name {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
            color: #2d3748;
            letter-spacing: -0.5px;
        }

        .doctor-name {
            font-size: 1.15rem;
            font-weight: 500;
            color: #319795;
            margin-bottom: 12px;
        }

        .practice-location {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 18px;
            letter-spacing: -0.5px;
        }

        .tagline {
            font-size: 1.25rem;
            font-weight: 500;
            color: #4a5568;
            margin-bottom: 12px;
        }

        .intro-text {
            font-size: 0.95rem;
            color: #718096;
            max-width: 600px;
            margin: 0 auto;
        }

        .progress-container {
            background: #f7fafc;
            padding: 25px 30px;
            border-bottom: 1px solid #e2e8f0;
        }

        .progress-bar-wrapper {
            position: relative;
            height: 8px;
            background: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #319795 0%, #48bb78 100%);
            border-radius: 10px;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            width: 12.5%;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #4a5568;
        }

        .step-indicator {
            font-weight: 600;
            color: #319795;
        }

        .form-wrapper {
            padding: 40px 30px;
        }

        .step {
            display: none;
        }

        .step.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 8px;
            padding-bottom: 10px;
            border-bottom: 3px solid #319795;
            display: inline-block;
        }

        .section-description {
            color: #718096;
            font-size: 0.95rem;
            margin-bottom: 25px;
        }

        .subsection {
            margin: 30px 0;
        }

        .subsection-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 15px;
            padding-left: 12px;
            border-left: 4px solid #319795;
        }

        .safety-alert {
            background: #fff5f5;
            border: 2px solid #fc8181;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .safety-alert-title {
            color: #c53030;
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 8px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .required {
            color: #e53e3e;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
            color: #2d3748;
            background: #ffffff;
            transition: all 0.3s ease;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: #319795;
            box-shadow: 0 0 0 3px rgba(49, 151, 149, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 10px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f7fafc;
        }

        .checkbox-label:hover {
            border-color: #319795;
            background: #edf2f7;
        }

        .checkbox-label input {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            accent-color: #319795;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .radio-label {
            display: flex;
            align-items: center;
            padding: 10px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f7fafc;
        }

        .radio-label:hover {
            border-color: #319795;
            background: #edf2f7;
        }

        .radio-label input {
            margin-right: 8px;
            width: 18px;
            height: 18px;
            accent-color: #319795;
        }

        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }

        .form-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .form-table th {
            background: #2d3748;
            color: white;
            padding: 14px 12px;
            text-align: left;
            font-weight: 600;
        }

        .form-table td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            background: white;
        }

        .form-table tr:last-child td {
            border-bottom: none;
        }

        .form-table input[type="text"], .form-table input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
        }

        .form-table input[type="radio"] {
            width: 20px;
            height: 20px;
            accent-color: #319795;
            cursor: pointer;
        }

        .help-text {
            font-size: 0.85rem;
            color: #718096;
            margin-top: 6px;
            font-style: italic;
        }

        .form-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #e2e8f0;
            gap: 10px;
        }

        .btn {
            padding: 14px 32px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #319795 0%, #48bb78 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(49, 151, 149, 0.4);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(49, 151, 149, 0.5);
        }

        .btn-secondary {
            background: #edf2f7;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .autosave-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 12px 20px;
            background: #48bb78;
            color: white;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(72, 187, 120, 0.4);
            font-size: 0.9rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1000;
        }

        .autosave-indicator.show {
            opacity: 1;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px 5px;
            }

            .header {
                padding: 30px 20px;
            }

            .brand-name {
                font-size: 2rem;
            }

            .practice-location {
                font-size: 2rem;
            }

            .logo-image {
                width: 80px;
                height: 80px;
            }

            .form-wrapper {
                padding: 30px 20px;
            }

            .progress-container {
                padding: 20px;
            }

            .form-navigation {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }

            .form-grid-2, .form-grid-3 {
                grid-template-columns: 1fr;
            }

            .checkbox-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-container">
                <img src="pausesleep-logo.jpg" alt="PauseSleep Logo" class="logo-image">
            </div>
            <div class="brand-name">PauseSleep</div>
            <div class="doctor-name">by Dr Premila Hewage</div>
            <div class="practice-location">at Modern Medical Balwyn</div>
            <div class="tagline">Women's Health Questionnaire</div>
            <p class="intro-text">
                Complete this form to help us provide safe, personalised care for your menopause and women's health needs.
            </p>
        </div>

        <div class="progress-container">
            <div class="progress-bar-wrapper">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="progress-info">
                <span class="step-indicator" id="stepIndicator">Step 1 of 8</span>
                <span id="progressPercent">13%</span>
            </div>
        </div>

        <div class="form-wrapper">
            <form id="womensHealthForm">
                <!-- Step 1: Personal Information -->
                <div class="step active" data-step="1">
                    <h2 class="section-title">Personal Information</h2>
                    <p class="section-description">Let's start with some basic information.</p>
                    
                    <div class="form-group">
                        <label class="form-label">Full Name <span class="required">*</span></label>
                        <input type="text" id="patient_name" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Date of Birth <span class="required">*</span></label>
                        <input type="date" id="dob" class="form-input" required>
                    </div>

                    <div class="form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Height (cm)</label>
                            <input type="number" id="height_cm" class="form-input" step="0.1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Weight (kg)</label>
                            <input type="number" id="weight_kg" class="form-input" step="0.1">
                        </div>
                    </div>
                </div>

                <!-- Step 2: Reason for Visit -->
                <div class="step" data-step="2">
                    <h2 class="section-title">Reason for Consultation</h2>
                    <p class="section-description">What brings you here today? (Select all that apply)</p>
                    
                    <div class="checkbox-group">
                        <label class="checkbox-label"><input type="checkbox" id="reason_menopause"><span>Menopause/Perimenopause symptoms</span></label>
                        <label class="checkbox-label"><input type="checkbox" id="reason_weight"><span>Weight management</span></label>
                        <label class="checkbox-label"><input type="checkbox" id="reason_contraception"><span>Contraception advice</span></label>
                        <label class="checkbox-label"><input type="checkbox" id="reason_periods"><span>Period concerns</span></label>
                        <label class="checkbox-label"><input type="checkbox" id="reason_sexual"><span>Sexual health concerns</span></label>
                        <label class="checkbox-label"><input type="checkbox" id="reason_bladder"><span>Bladder problems</span></label>
                        <label class="checkbox-label"><input type="checkbox" id="reason_breast"><span>Breast concerns</span></label>
                        <label class="checkbox-label"><input type="checkbox" id="reason_mental"><span>Mental health concerns</span></label>
                        <label class="checkbox-label"><input type="checkbox" id="reason_other_check"><span>Other</span></label>
                    </div>

                    <div class="form-group">
                        <label class="form-label">If other, please specify</label>
                        <input type="text" id="reason_other_text" class="form-input">
                    </div>
                </div>

                <!-- Step 3: Medical History -->
                <div class="step" data-step="3">
                    <h2 class="section-title">Medical History</h2>
                    
                    <div class="subsection">
                        <div class="safety-alert">
                            <div class="safety-alert-title">⚠️ Important for Treatment Safety</div>
                            <p style="color: #742a2a; font-size: 0.9rem;">Please check if you have EVER been diagnosed with any of these conditions</p>
                        </div>
                        
                        <div class="checkbox-group">
                            <label class="checkbox-label"><input type="checkbox" id="hx_breast_cancer"><span>Breast cancer</span></label>
                            <label class="checkbox-label"><input type="checkbox" id="hx_blood_clot"><span>Blood clot (DVT or pulmonary embolism)</span></label>
                            <label class="checkbox-label"><input type="checkbox" id="hx_heart_stroke"><span>Heart attack or stroke</span></label>
                            <label class="checkbox-label"><input type="checkbox" id="hx_liver"><span>Liver disease</span></label>
                            <label class="checkbox-label"><input type="checkbox" id="hx_endometrial"><span>Endometrial cancer or hyperplasia</span></label>
                            <label class="checkbox-label"><input type="checkbox" id="hx_ovarian"><span>Ovarian cancer</span></label>
                            <label class="checkbox-label"><input type="checkbox" id="hx_melanoma"><span>Melanoma</span></label>
                            <label class="checkbox-label"><input type="checkbox" id="hx_vaginal_bleeding"><span>Current unexplained vaginal bleeding</span></label>
                            <label class="checkbox-label"><input type="checkbox" id="hx_none"><span>None of the above</span></label>
                        </div>

                        <div class="form-group">
                            <label class="form-label">If you checked any conditions above, please provide year(s) diagnosed</label>
                            <textarea id="hx_details" class="form-textarea" rows="2"></textarea>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3 class="subsection-title">Allergies</h3>
                        <div class="form-group">
                            <label class="form-label">Do you have any allergies? <span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-label"><input type="radio" name="has_allergies" value="yes"><span>Yes</span></label>
                                <label class="radio-label"><input type="radio" name="has_allergies" value="no" checked><span>No</span></label>
                            </div>
                        </div>
                        <div class="form-grid-2">
                            <div class="form-group">
                                <label class="form-label">Allergy 1: Medication/Substance</label>
                                <input type="text" id="allergy1_med" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Reaction</label>
                                <input type="text" id="allergy1_reaction" class="form-input">
                            </div>
                        </div>
                        <div class="form-grid-2">
                            <div class="form-group">
                                <label class="form-label">Allergy 2: Medication/Substance</label>
                                <input type="text" id="allergy2_med" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Reaction</label>
                                <input type="text" id="allergy2_reaction" class="form-input">
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3 class="subsection-title">Other Medical Conditions</h3>
                        <div class="form-group">
                            <label class="form-label">Any other significant medical conditions?</label>
                            <textarea id="other_conditions" class="form-textarea" rows="3" placeholder="e.g., diabetes, thyroid disease, high blood pressure"></textarea>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3 class="subsection-title">Current Medications</h3>
                        <div class="form-group">
                            <label class="form-label">List ALL current medications <span class="required">*</span></label>
                            <textarea id="current_medications" class="form-textarea" rows="4" placeholder="Include vitamins, supplements, natural therapies"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Menstrual & Reproductive History -->
                <div class="step" data-step="4">
                    <h2 class="section-title">Menstrual & Reproductive History</h2>
                    
                    <div class="subsection">
                        <h3 class="subsection-title">Menstrual Status</h3>
                        <div class="form-group">
                            <label class="form-label">Are you currently having periods? <span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-label"><input type="radio" name="period_status" value="regular"><span>Yes, regular periods</span></label>
                                <label class="radio-label"><input type="radio" name="period_status" value="irregular"><span>Yes, irregular periods</span></label>
                                <label class="radio-label"><input type="radio" name="period_status" value="stopped"><span>No, periods have stopped</span></label>
                                <label class="radio-label"><input type="radio" name="period_status" value="na"><span>Not applicable (hysterectomy/IUD)</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">If periods stopped, when did they stop?</label>
                            <input type="text" id="periods_stopped_when" class="form-input" placeholder="e.g., 2 years ago, January 2024">
                        </div>
                    </div>

                    <div class="subsection">
                        <h3 class="subsection-title">Menstrual Concerns</h3>
                        <div class="form-group">
                            <label class="form-label">Do you experience any of these? (Check all that apply)</label>
                            <div class="checkbox-group">
                                <label class="checkbox-label"><input type="checkbox" id="concern_bleeding_outside"><span>Bleeding outside periods</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="concern_pain_sex"><span>Bleeding/pain with intercourse</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="concern_painful"><span>Painful periods</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="concern_heavy"><span>Heavy periods</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="concern_prolonged"><span>Prolonged periods</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Additional menstrual details</label>
                            <textarea id="menstrual_details" class="form-textarea" rows="2"></textarea>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3 class="subsection-title">Contraception</h3>
                        <div class="form-group">
                            <label class="form-label">Are you currently using contraception?</label>
                            <div class="radio-group">
                                <label class="radio-label"><input type="radio" name="using_contraception" value="yes"><span>Yes</span></label>
                                <label class="radio-label"><input type="radio" name="using_contraception" value="no"><span>No</span></label>
                                <label class="radio-label"><input type="radio" name="using_contraception" value="na"><span>Not applicable</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">What method?</label>
                            <input type="text" id="contraception_method" class="form-input">
                        </div>
                    </div>

                    <div class="subsection">
                        <h3 class="subsection-title">Pregnancy History</h3>
                        <div class="form-grid-3">
                            <div class="form-group">
                                <label class="form-label">Number of pregnancies</label>
                                <input type="number" id="num_pregnancies" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Vaginal births</label>
                                <input type="number" id="num_vaginal" class="form-input" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Caesarean births</label>
                                <input type="number" id="num_caesarean" class="form-input" min="0">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Number of miscarriages</label>
                            <input type="number" id="num_miscarriages" class="form-input" min="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Any pregnancy complications?</label>
                            <textarea id="pregnancy_complications" class="form-textarea" rows="2" placeholder="e.g., gestational diabetes, pre-eclampsia, post-partum hemorrhage"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Preventative Health -->
                <div class="step" data-step="5">
                    <h2 class="section-title">Preventative Health Screening</h2>
                    
                    <div class="subsection">
                        <h3 class="subsection-title">Screening Tests</h3>
                        <div class="form-grid-2">
                            <div class="form-group">
                                <label class="form-label">Last Cervical Screening Test (year)</label>
                                <input type="text" id="screen_cervical_year" class="form-input" placeholder="e.g., 2023">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Result</label>
                                <div class="radio-group">
                                    <label class="radio-label"><input type="radio" name="cervical_result" value="normal"><span>Normal</span></label>
                                    <label class="radio-label"><input type="radio" name="cervical_result" value="abnormal"><span>Abnormal</span></label>
                                    <label class="radio-label"><input type="radio" name="cervical_result" value="unsure"><span>Unsure</span></label>
                                </div>
                            </div>
                        </div>
                        <div class="form-grid-2">
                            <div class="form-group">
                                <label class="form-label">Last Mammogram (year)</label>
                                <input type="text" id="screen_mammo_year" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Last Bone Density scan (year)</label>
                                <input type="text" id="screen_bone_year" class="form-input">
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3 class="subsection-title">Family History</h3>
                        <div class="form-group">
                            <label class="form-label">Do any blood relatives have the following? (Check all that apply) <span class="required">*</span></label>
                            <div class="checkbox-group">
                                <label class="checkbox-label"><input type="checkbox" id="fh_breast"><span>Breast cancer</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="fh_ovarian"><span>Ovarian cancer</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="fh_heart"><span>Heart attack (before age 60)</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="fh_stroke"><span>Stroke (before age 60)</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="fh_clots"><span>Blood clots</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="fh_diabetes"><span>Diabetes</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="fh_none"><span>None of the above</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">For checked conditions, which relatives?</label>
                            <textarea id="fh_details" class="form-textarea" rows="2" placeholder="e.g., 'Mother - breast cancer, Sister - diabetes'"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Step 6: Lifestyle -->
                <div class="step" data-step="6">
                    <h2 class="section-title">Lifestyle Factors</h2>
                    
                    <div class="subsection">
                        <h3 class="subsection-title">Smoking & Vaping</h3>
                        <div class="form-group">
                            <label class="form-label">Do you currently smoke or vape? <span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-label"><input type="radio" name="current_smoke" value="yes"><span>Yes</span></label>
                                <label class="radio-label"><input type="radio" name="current_smoke" value="no" checked><span>No</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Have you smoked or vaped in the past? <span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-label"><input type="radio" name="past_smoke" value="yes"><span>Yes</span></label>
                                <label class="radio-label"><input type="radio" name="past_smoke" value="no" checked><span>No</span></label>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3 class="subsection-title">Alcohol</h3>
                        <div class="form-group">
                            <label class="form-label">Do you drink alcohol?</label>
                            <div class="radio-group">
                                <label class="radio-label"><input type="radio" name="alcohol_use" value="regular"><span>Yes, regularly</span></label>
                                <label class="radio-label"><input type="radio" name="alcohol_use" value="occasional"><span>Occasionally</span></label>
                                <label class="radio-label"><input type="radio" name="alcohol_use" value="no"><span>No</span></label>
                            </div>
                        </div>
                    </div>

                    <div class="subsection">
                        <h3 class="subsection-title">Exercise</h3>
                        <div class="form-group">
                            <label class="form-label">How often do you exercise?</label>
                            <div class="radio-group">
                                <label class="radio-label"><input type="radio" name="exercise_freq" value="daily"><span>Daily</span></label>
                                <label class="radio-label"><input type="radio" name="exercise_freq" value="several"><span>Several times per week</span></label>
                                <label class="radio-label"><input type="radio" name="exercise_freq" value="occasional"><span>Occasionally</span></label>
                                <label class="radio-label"><input type="radio" name="exercise_freq" value="rarely"><span>Rarely/Never</span></label>
                            </div>
                        </div>
                    </div>

                    <div class="subsection" id="weight_management_section" style="display:none;">
                        <h3 class="subsection-title">Weight Management Safety Screening</h3>
                        <div class="form-group">
                            <label class="form-label">Have you EVER had any of the following? (Check all that apply)</label>
                            <div class="checkbox-group">
                                <label class="checkbox-label"><input type="checkbox" id="wm_pancreatitis"><span>Pancreatitis</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="wm_gallbladder"><span>Gallbladder disease (including gallstones or removal)</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="wm_thyroid_cancer"><span>Medullary thyroid cancer (you or family member)</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="wm_men2"><span>MEN2 (Multiple Endocrine Neoplasia type 2)</span></label>
                                <label class="checkbox-label"><input type="checkbox" id="wm_none"><span>None of the above</span></label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 7: Relationship & Safety -->
                <div class="step" data-step="7">
                    <h2 class="section-title">Relationship & Safety</h2>
                    <p class="section-description">Your safety and wellbeing are important to us. This information is confidential.</p>
                    
                    <div class="form-group">
                        <label class="form-label">Are you currently afraid for your safety or worried about being harmed in your relationship? <span class="required">*</span></label>
                        <div class="radio-group">
                            <label class="radio-label"><input type="radio" name="rs_current_afraid" value="yes"><span>Yes</span></label>
                            <label class="radio-label"><input type="radio" name="rs_current_afraid" value="no" checked><span>No</span></label>
                            <label class="radio-label"><input type="radio" name="rs_current_afraid" value="prefer_not"><span>Prefer not to answer</span></label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Do you currently experience verbal, physical, or financial abuse? <span class="required">*</span></label>
                        <div class="radio-group">
                            <label class="radio-label"><input type="radio" name="rs_current_abuse" value="yes"><span>Yes</span></label>
                            <label class="radio-label"><input type="radio" name="rs_current_abuse" value="no" checked><span>No</span></label>
                            <label class="radio-label"><input type="radio" name="rs_current_abuse" value="prefer_not"><span>Prefer not to answer</span></label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Have you ever been afraid for your safety in a past relationship? <span class="required">*</span></label>
                        <div class="radio-group">
                            <label class="radio-label"><input type="radio" name="rs_past_afraid" value="yes"><span>Yes</span></label>
                            <label class="radio-label"><input type="radio" name="rs_past_afraid" value="no" checked><span>No</span></label>
                            <label class="radio-label"><input type="radio" name="rs_past_afraid" value="prefer_not"><span>Prefer not to answer</span></label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Have you experienced verbal, physical, or financial abuse in the past? <span class="required">*</span></label>
                        <div class="radio-group">
                            <label class="radio-label"><input type="radio" name="rs_past_abuse" value="yes"><span>Yes</span></label>
                            <label class="radio-label"><input type="radio" name="rs_past_abuse" value="no" checked><span>No</span></label>
                            <label class="radio-label"><input type="radio" name="rs_past_abuse" value="prefer_not"><span>Prefer not to answer</span></label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">History of childhood trauma? <span class="required">*</span></label>
                        <div class="radio-group">
                            <label class="radio-label"><input type="radio" name="rs_childhood_trauma" value="yes"><span>Yes</span></label>
                            <label class="radio-label"><input type="radio" name="rs_childhood_trauma" value="no" checked><span>No</span></label>
                            <label class="radio-label"><input type="radio" name="rs_childhood_trauma" value="prefer_not"><span>Prefer not to answer</span></label>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Would you like to seek help or support for any relationship or safety issues? <span class="required">*</span></label>
                        <div class="radio-group">
                            <label class="radio-label"><input type="radio" name="rs_wants_help" value="yes"><span>Yes</span></label>
                            <label class="radio-label"><input type="radio" name="rs_wants_help" value="no" checked><span>No</span></label>
                            <label class="radio-label"><input type="radio" name="rs_wants_help" value="not_now"><span>Not at this time</span></label>
                        </div>
                    </div>
                </div>

                <!-- Step 8: Menopause Symptoms -->
                <div class="step" data-step="8">
                    <h2 class="section-title">Menopause Symptoms</h2>
                    <p class="section-description">Please rate the severity of any symptoms you're experiencing.</p>
                    
                    <div class="table-container">
                        <table class="form-table">
                            <thead>
                                <tr>
                                    <th>Symptom</th>
                                    <th style="text-align:center;">None</th>
                                    <th style="text-align:center;">Mild</th>
                                    <th style="text-align:center;">Moderate</th>
                                    <th style="text-align:center;">Severe</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>Hot flushes/night sweats</td><td style="text-align:center;"><input type="radio" name="sym_hot_flushes" value="none" checked></td><td style="text-align:center;"><input type="radio" name="sym_hot_flushes" value="mild"></td><td style="text-align:center;"><input type="radio" name="sym_hot_flushes" value="moderate"></td><td style="text-align:center;"><input type="radio" name="sym_hot_flushes" value="severe"></td></tr>
                                <tr><td>Irritability</td><td style="text-align:center;"><input type="radio" name="sym_irritability" value="none" checked></td><td style="text-align:center;"><input type="radio" name="sym_irritability" value="mild"></td><td style="text-align:center;"><input type="radio" name="sym_irritability" value="moderate"></td><td style="text-align:center;"><input type="radio" name="sym_irritability" value="severe"></td></tr>
                                <tr><td>Low mood/Depression</td><td style="text-align:center;"><input type="radio" name="sym_depression" value="none" checked></td><td style="text-align:center;"><input type="radio" name="sym_depression" value="mild"></td><td style="text-align:center;"><input type="radio" name="sym_depression" value="moderate"></td><td style="text-align:center;"><input type="radio" name="sym_depression" value="severe"></td></tr>
                                <tr><td>Anxiety</td><td style="text-align:center;"><input type="radio" name="sym_anxiety" value="none" checked></td><td style="text-align:center;"><input type="radio" name="sym_anxiety" value="mild"></td><td style="text-align:center;"><input type="radio" name="sym_anxiety" value="moderate"></td><td style="text-align:center;"><input type="radio" name="sym_anxiety" value="severe"></td></tr>
                                <tr><td>Mood swings</td><td style="text-align:center;"><input type="radio" name="sym_mood_swings" value="none" checked></td><td style="text-align:center;"><input type="radio" name="sym_mood_swings" value="mild"></td><td style="text-align:center;"><input type="radio" name="sym_mood_swings" value="moderate"></td><td style="text-align:center;"><input type="radio" name="sym_mood_swings" value="severe"></td></tr>
                                <tr><td>Poor sleep/Insomnia</td><td style="text-align:center;"><input type="radio" name="sym_sleep" value="none" checked></td><td style="text-align:center;"><input type="radio" name="sym_sleep" value="mild"></td><td style="text-align:center;"><input type="radio" name="sym_sleep" value="moderate"></td><td style="text-align:center;"><input type="radio" name="sym_sleep" value="severe"></td></tr>
                                <tr><td>Fatigue</td><td style="text-align:center;"><input type="radio" name="sym_fatigue" value="none" checked></td><td style="text-align:center;"><input type="radio" name="sym_fatigue" value="mild"></td><td style="text-align:center;"><input type="radio" name="sym_fatigue" value="moderate"></td><td style="text-align:center;"><input type="radio" name="sym_fatigue" value="severe"></td></tr>
                                <tr><td>Reduced sexual desire</td><td style="text-align:center;"><input type="radio" name="sym_libido" value="none" checked></td><td style="text-align:center;"><input type="radio" name="sym_libido" value="mild"></td><td style="text-align:center;"><input type="radio" name="sym_libido" value="moderate"></td><td style="text-align:center;"><input type="radio" name="sym_libido" value="severe"></td></tr>
                                <tr><td>Vaginal dryness</td><td style="text-align:center;"><input type="radio" name="sym_vaginal_dryness" value="none" checked></td><td style="text-align:center;"><input type="radio" name="sym_vaginal_dryness" value="mild"></td><td style="text-align:center;"><input type="radio" name="sym_vaginal_dryness" value="moderate"></td><td style="text-align:center;"><input type="radio" name="sym_vaginal_dryness" value="severe"></td></tr>
                                <tr><td>Painful intercourse</td><td style="text-align:center;"><input type="radio" name="sym_painful_sex" value="none" checked></td><td style="text-align:center;"><input type="radio" name="sym_painful_sex" value="mild"></td><td style="text-align:center;"><input type="radio" name="sym_painful_sex" value="moderate"></td><td style="text-align:center;"><input type="radio" name="sym_painful_sex" value="severe"></td></tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="subsection">
                        <h3 class="subsection-title">Current Menopause Management</h3>
                        <div class="form-group">
                            <label class="form-label">Are you currently taking HRT or other medications for menopause symptoms? <span class="required">*</span></label>
                            <div class="radio-group">
                                <label class="radio-label"><input type="radio" name="taking_hrt" value="yes"><span>Yes</span></label>
                                <label class="radio-label"><input type="radio" name="taking_hrt" value="no" checked><span>No</span></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Please list all HRT medications with doses</label>
                            <textarea id="hrt_details" class="form-textarea" rows="3" placeholder="e.g., 'Estradot 50mcg patch twice weekly, Prometrium 100mg daily'"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">What other approaches are you using to manage symptoms?</label>
                            <textarea id="other_management" class="form-textarea" rows="3" placeholder="e.g., lifestyle changes, supplements, complementary therapies"></textarea>
                        </div>
                    </div>
                </div>

                <div class="form-navigation">
                    <button type="button" class="btn btn-secondary" id="prevBtn" onclick="changeStep(-1)" style="display:none;">← Previous</button>
                    <button type="button" class="btn btn-primary" id="nextBtn" onclick="changeStep(1)">Next →</button>
                    <button type="button" class="btn btn-primary" id="submitBtn" onclick="submitForm()" style="display:none;">Submit Questionnaire</button>
                </div>
            </form>
        </div>
    </div>

    <div class="autosave-indicator" id="autosaveIndicator">✓ Progress saved</div>

    <script>
        let currentStep = 1;
        const totalSteps = 8;

        // Show/hide weight management section based on reason for visit
        document.getElementById('reason_weight').addEventListener('change', function() {
            const wmSection = document.getElementById('weight_management_section');
            if (this.checked) {
                wmSection.style.display = 'block';
            } else {
                wmSection.style.display = 'none';
            }
        });

        function getRadioValue(name) {
            const el = document.querySelector('input[name="' + name + '"]:checked');
            return el ? el.value : "";
        }

        function getValue(id) {
            const el = document.getElementById(id);
            return el ? el.value.trim() : "";
        }

        function getChecked(id) {
            const el = document.getElementById(id);
            return el ? el.checked : false;
        }

        function showStep(n) {
            const steps = document.querySelectorAll('.step');
            if (n > totalSteps) n = totalSteps;
            if (n < 1) n = 1;
            
            steps.forEach((step, index) => {
                step.classList.remove('active');
                if (index === n - 1) step.classList.add('active');
            });

            document.getElementById('prevBtn').style.display = n === 1 ? 'none' : 'inline-block';
            document.getElementById('nextBtn').style.display = n === totalSteps ? 'none' : 'inline-block';
            document.getElementById('submitBtn').style.display = n === totalSteps ? 'inline-block' : 'none';

            const progress = (n / totalSteps) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('stepIndicator').textContent = `Step ${n} of ${totalSteps}`;
            document.getElementById('progressPercent').textContent = Math.round(progress) + '%';
            
            currentStep = n;
            window.scrollTo({ top: 0, behavior: 'smooth' });
            saveProgress();
        }

        function changeStep(direction) {
            showStep(currentStep + direction);
        }

        function saveProgress() {
            const indicator = document.getElementById('autosaveIndicator');
            indicator.classList.add('show');
            setTimeout(() => indicator.classList.remove('show'), 2000);
        }

        async function submitForm() {
            const nameField = document.getElementById('patient_name');
            const dobField = document.getElementById('dob');

            if (!nameField.value.trim()) {
                alert('Please enter your name before submitting.');
                showStep(1);
                nameField.focus();
                return;
            }

            if (!dobField.value) {
                alert('Please enter your date of birth before submitting.');
                showStep(1);
                dobField.focus();
                return;
            }

            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            const data = {
                patient_name: getValue("patient_name"),
                dob: getValue("dob"),
                height_cm: getValue("height_cm"),
                weight_kg: getValue("weight_kg"),

                reason_for_visit: {
                    menopause: getChecked("reason_menopause"),
                    weight_management: getChecked("reason_weight"),
                    contraception: getChecked("reason_contraception"),
                    periods: getChecked("reason_periods"),
                    sexual_health: getChecked("reason_sexual"),
                    bladder: getChecked("reason_bladder"),
                    breast: getChecked("reason_breast"),
                    mental_health: getChecked("reason_mental"),
                    other_checked: getChecked("reason_other_check"),
                    other_text: getValue("reason_other_text")
                },

                medical_history_safety: {
                    breast_cancer: getChecked("hx_breast_cancer"),
                    blood_clot: getChecked("hx_blood_clot"),
                    heart_stroke: getChecked("hx_heart_stroke"),
                    liver_disease: getChecked("hx_liver"),
                    endometrial_cancer: getChecked("hx_endometrial"),
                    ovarian_cancer: getChecked("hx_ovarian"),
                    melanoma: getChecked("hx_melanoma"),
                    vaginal_bleeding: getChecked("hx_vaginal_bleeding"),
                    none: getChecked("hx_none"),
                    details: getValue("hx_details")
                },

                allergies: {
                    has_allergies: getRadioValue("has_allergies"),
                    allergy1: { medication: getValue("allergy1_med"), reaction: getValue("allergy1_reaction") },
                    allergy2: { medication: getValue("allergy2_med"), reaction: getValue("allergy2_reaction") }
                },

                other_conditions: getValue("other_conditions"),
                current_medications: getValue("current_medications"),

                menstrual_reproductive: {
                    period_status: getRadioValue("period_status"),
                    periods_stopped_when: getValue("periods_stopped_when"),
                    concerns: {
                        bleeding_outside: getChecked("concern_bleeding_outside"),
                        pain_with_sex: getChecked("concern_pain_sex"),
                        painful_periods: getChecked("concern_painful"),
                        heavy_periods: getChecked("concern_heavy"),
                        prolonged_periods: getChecked("concern_prolonged")
                    },
                    additional_details: getValue("menstrual_details"),
                    using_contraception: getRadioValue("using_contraception"),
                    contraception_method: getValue("contraception_method")
                },

                pregnancy_history: {
                    num_pregnancies: getValue("num_pregnancies"),
                    num_vaginal: getValue("num_vaginal"),
                    num_caesarean: getValue("num_caesarean"),
                    num_miscarriages: getValue("num_miscarriages"),
                    complications: getValue("pregnancy_complications")
                },

                screening: {
                    cervical_year: getValue("screen_cervical_year"),
                    cervical_result: getRadioValue("cervical_result"),
                    mammogram_year: getValue("screen_mammo_year"),
                    bone_density_year: getValue("screen_bone_year")
                },

                family_history: {
                    breast_cancer: getChecked("fh_breast"),
                    ovarian_cancer: getChecked("fh_ovarian"),
                    heart_attack: getChecked("fh_heart"),
                    stroke: getChecked("fh_stroke"),
                    blood_clots: getChecked("fh_clots"),
                    diabetes: getChecked("fh_diabetes"),
                    none: getChecked("fh_none"),
                    details: getValue("fh_details")
                },

                lifestyle: {
                    current_smoke: getRadioValue("current_smoke"),
                    past_smoke: getRadioValue("past_smoke"),
                    alcohol_use: getRadioValue("alcohol_use"),
                    exercise_frequency: getRadioValue("exercise_freq")
                },

                weight_management_safety: {
                    pancreatitis: getChecked("wm_pancreatitis"),
                    gallbladder: getChecked("wm_gallbladder"),
                    thyroid_cancer: getChecked("wm_thyroid_cancer"),
                    men2: getChecked("wm_men2"),
                    none: getChecked("wm_none")
                },

                relationship_safety: {
                    current_afraid: getRadioValue("rs_current_afraid"),
                    current_abuse: getRadioValue("rs_current_abuse"),
                    past_afraid: getRadioValue("rs_past_afraid"),
                    past_abuse: getRadioValue("rs_past_abuse"),
                    childhood_trauma: getRadioValue("rs_childhood_trauma"),
                    wants_help: getRadioValue("rs_wants_help")
                },

                menopause_symptoms: {
                    hot_flushes: getRadioValue("sym_hot_flushes"),
                    irritability: getRadioValue("sym_irritability"),
                    depression: getRadioValue("sym_depression"),
                    anxiety: getRadioValue("sym_anxiety"),
                    mood_swings: getRadioValue("sym_mood_swings"),
                    sleep: getRadioValue("sym_sleep"),
                    fatigue: getRadioValue("sym_fatigue"),
                    libido: getRadioValue("sym_libido"),
                    vaginal_dryness: getRadioValue("sym_vaginal_dryness"),
                    painful_sex: getRadioValue("sym_painful_sex")
                },

                menopause_management: {
                    taking_hrt: getRadioValue("taking_hrt"),
                    hrt_details: getValue("hrt_details"),
                    other_management: getValue("other_management")
                }
            };

            try {
                const response = await fetch(
                    "https://gekabqqvbgvjtstxqsie.supabase.co/functions/v1/submit-womens-form",
                    {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(data)
                    }
                );

                if (!response.ok) {
                    const result = await response.json();
                    throw new Error(JSON.stringify(result));
                }

                window.location.href = "thank-you.html";

            } catch (err) {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit Questionnaire';
                alert("Submission error: " + err.message + "\n\nPlease check your internet connection and try again.");
            }
        }

        showStep(1);
    </script>
</body>
</html>